// 84
[proc,rebuildchatbox]
def_int $int0 = 0;
def_int $int1 = 0;
def_int $chattype2 = ^chattype_gamemessage;
def_component $component3 = null;
def_int $int4 = 0;
if (%varclient_41 = 3) {
    $int4 = 1;
}
while ($int1 < 100) {
    if (~panetest($int1) = true & ~filtertest($int1, $int4) = true) {
        $int0 = calc($int0 + 1);
    }
    $int1 = calc($int1 + 1);
}
if ($int0 < 8) {
    $int0 = 8;
    ~script85(interface_137:com4);
    ~script85(interface_137:com5);
    ~script85(interface_137:com6);
    ~script85(interface_137:com7);
    ~script85(interface_137:com8);
    ~script85(interface_137:com9);
    ~script85(interface_137:com10);
    ~script85(interface_137:com11);
}
if_setscrollsize(463, calc($int0 * 14 + 2), interface_137:com2);
~scrollbar_resize(interface_137:com3, interface_137:com2, calc(%varclient_7 + (if_getscrollheight(interface_137:com2) - %varclient_8)));
%varclient_7 = if_getscrolly(interface_137:com2);
%varclient_8 = if_getscrollheight(interface_137:com2);
if ($int0 < 100) {
    ~script85(enum(int, component, enum_579, $int0));
}
$int1 = 0;
while ($int1 < 100) {
    if (~panetest($int1) = true & ~filtertest($int1, $int4) = true) {
        $int0 = calc($int0 - 1);
        $component3 = enum(int, component, enum_579, $int0);
        $chattype2 = chat_gethistorytype($int1);
        if ($chattype2 = ^chattype_gamemessage | $chattype2 = ^chattype_friendschatnotification | $chattype2 = ^chattype_12 | $chattype2 = ^chattype_13) {
            if_settext(chat_gethistorymessage($int1), $component3);
        }
        if ($chattype2 = ^chattype_modchat) {
            if_settext("<chat_gethistoryname($int1)>: <col=0000ff><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_publicchat) {
            if_settext("<chat_gethistoryname($int1)>: <col=0000ff><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_privatechat) {
            if_settext("From <chat_gethistoryname($int1)>: <col=800000><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_engine) {
            if_settext("<col=800080><chat_gethistoryname($int1)> <chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_loginlogoutnotification) {
            if_settext("<col=800000><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_privatechatout) {
            if_settext("To <chat_gethistoryname($int1)>: <col=800000><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_modprivatechat) {
            if_settext("From <chat_gethistoryname($int1)>: <col=800000><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_8) {
            if_settext("<col=7e3200><chat_gethistoryname($int1)> <chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_friendschat) {
            if_settext("[<col=0000ff><chat_gethistoryclan($int1)><col=000000>] <chat_gethistoryname($int1)>: <col=800000><chat_gethistorymessage($int1)>", $component3);
        }
        if ($chattype2 = ^chattype_10) {
            if_settext("<col=800080><chat_gethistoryname($int1)> is asking for assistance.", $component3);
        }
        if_clearops($component3);
        if ($chattype2 = ^chattype_modchat | $chattype2 = ^chattype_publicchat | $chattype2 = ^chattype_privatechat | $chattype2 = ^chattype_modprivatechat | $chattype2 = ^chattype_friendschat) {
            if_setopbase("<col=ffffff><chat_gethistoryname($int1)>", $component3);
            if_setop(6, "Add friend", $component3);
            if_setop(7, "Add ignore", $component3);
            if (staffmodlevel > 0 | playermod > 0) {
                if_setop(8, "Report abuse", $component3);
            }
        } else if ($chattype2 = ^chattype_engine) {
            if_setopbase("<col=ffffff><chat_gethistoryname($int1)>", $component3);
            if_setop(1, "Accept trade", $component3);
        } else if ($chattype2 = ^chattype_8) {
            if_setopbase("<col=ffffff><chat_gethistoryname($int1)>", $component3);
            if_setop(2, "Accept challenge", $component3);
        } else if ($chattype2 = ^chattype_10) {
            if_setopbase("<col=ffffff><chat_gethistoryname($int1)>", $component3);
            if_setop(3, "Give assistance", $component3);
        }
    }
    $int1 = calc($int1 + 1);
}
